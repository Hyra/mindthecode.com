<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="Mindthecode" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>Let's build: An AngularJS app with Browserify and Gulp - Mindthecode</title><link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><header><a href="/" class="logo"><img src="http://mindthecode.com/logo.png" height="30"></a><nav><ul><li><a href="/">Blog</a></li><li><a href="/about">About</a></li><li><a href="/atom.xml">RSS</a></li></ul></nav></header><main><article class="post"><header><h1><span>Let's build: An AngularJS app with Browserify and Gulp</span></h1><h5><span>Describing a generic workflow and setup</span></h5><time datetime="2016-11-22T16:42:15.000Z" class="post__time">Nov 22 2016</time></header><hr/><p>Today I want to show a generic workflow and setup I have used a lot lately when working on building apps with Angular. It uses Gulp as a CI system and Browserify to minimize code clutter and maximize awesomeness. So let’s jump in.</p>
<h2 id="Update-21-october-2014-Frickle"><a href="#Update-21-october-2014-Frickle" class="headerlink" title="Update 21 october 2014 - Frickle"></a>Update 21 october 2014 - Frickle</h2><p>As with most things, boilerplates evolve. I decided to expand the boilerplate we’re building below with a backend for the API side, as well as cleaning up some things based on new findings and updated modules. To find out more about that have a look at <a href="http://github.com/Hyra/Frickle" target="_blank" rel="external">Frickle</a>.</p>
<h2 id="Let’s-get-started"><a href="#Let’s-get-started" class="headerlink" title="Let’s get started!"></a>Let’s get started!</h2><p>Instead of starting from a cloned code repository let’s build our setup together. From scratch. This way you know what each piece does, and allows you to tweak it to your liking. Of course, the final product can be found <a href="https://github.com/Hyra/angular-gulp-browserify-livereload-boilerplate" target="_blank" rel="external">here</a> at Github, but it might be better to use it as a reference rather than a starting point.</p>
<h2 id="Folder-structure"><a href="#Folder-structure" class="headerlink" title="Folder structure"></a>Folder structure</h2><p>When building a web application I tend to have an <code>app</code> folder for the original source files, and a <code>dist</code> folder which contains all the processed files and will serve as the root directory for the webserver. So let’s create the following folder structure:</p>
<pre class=" language-bash"><code class="language-bash">- app
  - index.html
  - images            // Visual assets
  - scripts           // Your javascript
     - controllers
     - directives
     - services
     - main.js        // Single main entry point
  - styles            // SCSS or LESS or CSS files
  - views             // Templates
- dist                // The target and <span class="token string">'www'</span> folder
- Gulpfile.js         // Gulp instructions <span class="token function">file</span>
- package.json        // Package <span class="token function">file</span> with installation references
</code></pre>
<h2 id="Getting-some-modules"><a href="#Getting-some-modules" class="headerlink" title="Getting some modules"></a>Getting some modules</h2><p>To get everything up and running, let’s first get some NPM modules we want to work with. Depending on your personal preferences you might want to replace some of them or add other ones to suit your specific needs. The modules I usually install are:</p>
<h2 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h2><p>This is the workhorse of our setup.</p>
<h2 id="Angular"><a href="#Angular" class="headerlink" title="Angular"></a>Angular</h2><p>We will install Angular through NPM so we can require it with browserify.</p>
<h2 id="Browserify"><a href="#Browserify" class="headerlink" title="Browserify"></a>Browserify</h2><p>Browserify allows us to utilize the <code>require()</code> syntax we love in NodeJS in our front-end. Can you spell u.n.i.c.o.r.n.s ?</p>
<h2 id="gulp-browserify"><a href="#gulp-browserify" class="headerlink" title="gulp-browserify"></a>gulp-browserify</h2><p>This allows us to run Browserify from within our Gulpfile.</p>
<h2 id="gulp-clean"><a href="#gulp-clean" class="headerlink" title="gulp-clean"></a>gulp-clean</h2><p>Allows us to clean (empty) a folder or file, which is nice to make sure we don’t end up with any artifacts.</p>
<h2 id="gulp-concat"><a href="#gulp-concat" class="headerlink" title="gulp-concat"></a>gulp-concat</h2><p>When using browserify for our code we want to concat it to a single bundled javascript file. This plugin allows us to do just that.</p>
<h2 id="gulp-jshint"><a href="#gulp-jshint" class="headerlink" title="gulp-jshint"></a>gulp-jshint</h2><p>We all love syntactically correct code, don’t we? This plugin checks your javascript files and tells you when something is wrong. Or not pretty enough.</p>
<h2 id="gulp-util"><a href="#gulp-util" class="headerlink" title="gulp-util"></a>gulp-util</h2><p>General gulp utilities, such as colour in your <code>gutil.log()</code> calls, and handy methods for common operations such as <code>replaceExtension()</code> and <code>noop()</code>.</p>
<h2 id="gulp-embedlr-gulp-livereload-tiny-lr-connect-livereload-express"><a href="#gulp-embedlr-gulp-livereload-tiny-lr-connect-livereload-express" class="headerlink" title="gulp-embedlr, gulp-livereload, tiny-lr, connect-livereload, express"></a>gulp-embedlr, gulp-livereload, tiny-lr, connect-livereload, express</h2><p>These I use so I can run a local webserver and support live reloading of the app as we save files.</p>
<p>And this will do fine for now. So! Let’s install all these babies, and save them to our <code>package.json</code> by adding <code>--save-dev</code></p>
<pre class=" language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> gulp browserify gulp-browserify gulp-clean gulp-concat gulp-jshint gulp-util gulp-embedlr gulp-livereload tiny-lr connect-livereload express --save-dev
</code></pre>
<!-- Rectangle Ad -->
<p><center><br><ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-0534492338431642" data-ad-slot="3199566305"></ins><br></center></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="Configuring-our-Gulpfile"><a href="#Configuring-our-Gulpfile" class="headerlink" title="Configuring our Gulpfile"></a>Configuring our Gulpfile</h2><p>Now we have all the components in place it’s time to write our Gulpfile. Let’s start small and expand as we go along.</p>
<p>First, let’s make sure we can <code>watch</code> our javascript files, and as they change, run them through JSHint and have Browserify bundle the code into a single file:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    gutil <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-util'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    jshint <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-jshint'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    browserify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-browserify'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    concat <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-concat'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    clean <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-clean'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// JSHint task</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'lint'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./app/scripts/*.js'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">jshint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">/</span><span class="token operator">/</span> You can look into pretty reporters <span class="token keyword">as</span> well<span class="token punctuation">,</span> but that's another story
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>jshint<span class="token punctuation">.</span><span class="token function">reporter</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">/</span><span class="token operator">/</span> Browserify task
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'browserify'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">/</span><span class="token operator">/</span> Single point <span class="token keyword">of</span> entry <span class="token punctuation">(</span>make sure not to src ALL your files<span class="token punctuation">,</span> browserify will figure it out <span class="token keyword">for</span> you<span class="token punctuation">)</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'app/scripts/main.js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">browserify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    insertGlobals<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    debug<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">/</span><span class="token operator">/</span> Bundle to a single file
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">'bundle.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">/</span><span class="token operator">/</span> Output it to our dist folder
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'watch'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'lint'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">/</span><span class="token operator">/</span> Watch our scripts
  gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'app/scripts/*.js'</span><span class="token punctuation">,</span> <span class="token string">'app/scripts/**/*.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>
    <span class="token string">'lint'</span><span class="token punctuation">,</span>
    <span class="token string">'browserify'</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>So far so good! Whenever we change code in our javascript files a fresh bundle.js is created for us to use in our site.</p>
<h2 id="Set-up-our-index-html-file"><a href="#Set-up-our-index-html-file" class="headerlink" title="Set up our index.html file"></a>Set up our index.html file</h2><p>Let’s create a simple <code>index.html</code> file so we can see our work in the browser. Open up <code>index.html</code> and add something like the following:</p>
<pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!doctype html></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">ng-app</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myApp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>My Awesome App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">ng-controller</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>WelcomeCtrl<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>My Awesome App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>{{testVar}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/js/bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>The above should look familiar. We include our bundle.js file we created earlier at the bottom, initiate a ng-app by adding the directive to the html tag, attach a controller to the body and have a simple variable in the body so we can see if things work. Which at this point is a NO. Let’s fix that.</p>
<p>First of all, we want this index.html file to be added to our <code>dist</code> folder so we can actually serve it. We can do this by adding an extra task:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// Views task</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Get our index.html</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'app/index.html'</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true">// And put it in the dist folder</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment" spellcheck="true">// Any other view files from app/views</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./app/views/**/*'</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true">// Will be put in the dist/views folder</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/views/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>We can also set up another watcher in the watch task to pick up any changes as we build:</p>
<pre class=" language-javascript"><code class="language-javascript">gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'app/index.html'</span><span class="token punctuation">,</span> <span class="token string">'app/views/**/*.html'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token string">'views'</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>At the moment we pretty much have a working app. We just can’t see it. Let’s change this by adding a self contained webserver, straight from our Gulp.</p>
<h2 id="Webserver-with-live-reload"><a href="#Webserver-with-live-reload" class="headerlink" title="Webserver with live reload"></a>Webserver with live reload</h2><p>First of all, we need to add some modules to our Gulpfile that allows us to run a mini express server.</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> embedlr <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-embedlr'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    refresh <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-livereload'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    lrserver <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tiny-lr'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    livereload <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'connect-livereload'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    livereloadport <span class="token operator">=</span> <span class="token number">35729</span><span class="token punctuation">,</span>
    serverport <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Set up an express server (but not starting it yet)</span>
<span class="token keyword">var</span> server <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// Add live reload</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">livereload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>port<span class="token punctuation">:</span> livereloadport<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// Use our 'dist' folder as rootfolder</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token keyword">static</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// Because I like HTML5 pushstate .. this redirects everything back to our index.html</span>
server<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'/*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">sendfile</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> root<span class="token punctuation">:</span> <span class="token string">'dist'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Next, let’s start the server. You can do this from any task, but let’s create a <code>dev</code> task for the fun of it.</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// Dev task</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'dev'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Start webserver</span>
  server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>serverport<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// Start live reload</span>
  lrserver<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>livereloadport<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// Run the watch task, to keep taps on changes</span>
  gulp<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'watch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now, when you run <code>gulp dev</code> it will kickstart our internal webserver with our <code>dist</code> folder as root. You can verify everything is working by navigating to <a href="http://localhost:5000" target="_blank" rel="external">http://localhost:5000</a></p>
<p>If all is well you should see the <code>index.html</code> show up. Whenever you change a file however, the changes won’t automatically show up in the browser. This is because we have to manually invoke the server refresh from within our task. Let’s modify our <code>views</code> task to automatically refresh the browser after it has done its work:</p>
<pre class=" language-javascript"><code class="language-javascript">gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./app/index.html'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./app/views/**/*'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/views/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">refresh</span><span class="token punctuation">(</span>lrserver<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Tell the lrserver to refresh</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now, whenever you change a view file, the server will reload. Of course, you can do this whenever you want. So feel free to add it in the <code>browserify</code> task as well.</p>
<h2 id="Add-some-Angular"><a href="#Add-some-Angular" class="headerlink" title="Add some Angular"></a>Add some Angular</h2><p>We are getting somewhere. All that’s missing is some actual Angular code. So let’s add some. Open up the <code>main.js</code> file and put in the following:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> angular <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'angular'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// That's right! We can just require angular as if we were in node</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> angular<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">'myApp'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">'HelloCtrl'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>$scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  $scope<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token string">'Test varretjes'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>In main.js we can now use Node’s <code>require()</code> way to include modules we want. This is not limited to our own code, we can use most of the ~50k published modules on npmjs.org. When we run <code>gulp browserify</code> Browserify will figure out what code to pull in, and will bundle it in our <code>bundle.js</code>. Good stuff.</p>
<p>Of course, the controller code should move to a file of its own in the controllers directory so we can actually use the <code>require</code> technique. So let’s do just that.</p>
<p>Create a new file <code>controllers/WelcomeCtrl.js</code> and add in the following:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> WelcomeCtrl <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>$scope<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  $scope<span class="token punctuation">.</span>testVar <span class="token operator">=</span> <span class="token string">'We are up and running from a required module!'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> WelcomeCtrl<span class="token punctuation">;</span>
</code></pre>
<p>Notice we use <code>module.exports</code> to expose (parts of) our code, as you do with modules. This way we can <code>require</code> them from our <code>main.js</code> file and use it as a module. Let’s change <code>main.js</code> to use our fresh module:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> angular <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'angular'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// That's right! We can just require angular as if we were in node</span>

<span class="token keyword">var</span> WelcomeCtrl <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./controllers/WelcomeCtrl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// We can use our WelcomeCtrl.js as a module. Rainbows.</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> angular<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">'myApp'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token string">'WelcomeCtrl'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'$scope'</span><span class="token punctuation">,</span> WelcomeCtrl<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This is obviously a very bare example, but you can see how using simple <code>require</code> calls will save a lot of script tags in your index.html, and having your files behave as modules helps you write re-usable code.</p>
<h2 id="JSHint-rc"><a href="#JSHint-rc" class="headerlink" title="JSHint.rc"></a>JSHint.rc</h2><p>You might have noticed <code>gulp lint</code> gives us some errors. That’s because it needs some guidance, as it doesn’t know about our <code>require</code> and preferences. Let’s add a file called <code>.jshintrc</code> and add in the following configuration:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token string">"node"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"browser"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"esnext"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"bitwise"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"camelcase"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"curly"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"eqeqeq"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"immed"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"indent"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token string">"latedef"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"newcap"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"noarg"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"quotmark"</span><span class="token punctuation">:</span> <span class="token string">"single"</span><span class="token punctuation">,</span>
  <span class="token string">"regexp"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"undef"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"unused"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"strict"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"trailing"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"smarttabs"</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre>
<p>You may or may not agree with any of these settings, so feel free to tweak them.</p>
<h2 id="SASS-Support"><a href="#SASS-Support" class="headerlink" title="SASS Support"></a>SASS Support</h2><p>You may have a CSS pre-processor of choice, so let’s add support for this. I usually go with SASS, but of course this is adaptable to your liking. Let’s install a new module named <code>gulp-sass</code> and include it in our Gulpfile.</p>
<pre class=" language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> gulp-sass gulp-autoprefixer --save-dev
</code></pre>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-sass'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// Not necessary, but I like this one, it automatically adds prefixes for all browsers</span>
<span class="token keyword">var</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Next, let’s write a task for it:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// Styles task</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'styles'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'app/styles/*.scss'</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true">// The onerror handler prevents Gulp from crashing when you make a mistake in your SASS</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">sass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>onError<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true">// Optionally add autoprefixer</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token string">"last 2 versions"</span><span class="token punctuation">,</span> <span class="token string">"> 1%"</span><span class="token punctuation">,</span> <span class="token string">"ie 8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment" spellcheck="true">// These last two should look familiar now :)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/css/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">refresh</span><span class="token punctuation">(</span>lrserver<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>And add another watcher.</p>
<pre class=" language-javascript"><code class="language-javascript">gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'app/styles/**/*.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token string">'styles'</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now, whenever you make changes to your SASS files it will compile it to CSS and live-reload our webserver. Good times.</p>
<h2 id="Wrapping-up"><a href="#Wrapping-up" class="headerlink" title="Wrapping up"></a>Wrapping up</h2><p>We’ve done quite a lot. We have set up a webserver, added Gulp to automate all our tasks, added live reloading for easy developing, sass processing, and added support for Browserify so we can script in style.</p>
<p>I created a repository with the above so you can check the finished project, which you can find <a href="https://github.com/Hyra/angular-gulp-browserify-livereload-boilerplate" target="_blank" rel="external">here</a>.</p>
<p>I hope the above was of some help, and if you have any questions feel free to find me on <a href="http://twitter.com/stefvdham" target="_blank" rel="external">Twitter</a>, or leave a comment below.</p>
<p>Happy coding.</p>
<hr/><ul class="tags"><li>Tags: </li><li class="post__tag__item"><a href="/tags/angular/" class="post__tag__link">angular</a></li><li class="post__tag__item"><a href="/tags/browserify/" class="post__tag__link">browserify</a></li><li class="post__tag__item"><a href="/tags/gulp/" class="post__tag__link">gulp</a></li></ul><a href="https://twitter.com/intent/tweet" class="twitter-share-button">Tweet</a><hr/><h2>Questions or comments?</h2><p>As always, if you have any questions or comments, you can find me on <a href="http://twitter.com/stefvdham"   target="_blank">Twitter</a>.</p><div class="prevnext"><a href="/2014-05-25-recording-a-website-with-phantomjs-and-ffmpeg/" class="prevnext-prev"><p>← Prev</p></a><a href="/2011-05-26-how-to-remove-a-submodule-from-your-git-repository/" class="prevnext-next"><p>Next →</p></a></div></article></main><footer><a href="/"><img src="http://mindthecode.com/images/mtc_inv_white.png" alt="Mindthecode"></a><br><p>Made with ❤ and 🍺</p><p>© Copyright 2011-2017</p></footer><script src="/js/main.js"></script><script async="async" type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&amp;serve=C6AILKT&amp;placement=mindthecode" id="_carbonads_js"></script></body></html>