<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="Mindthecode" type="application/atom+xml"><link rel="icon" href="/favicon.png"><meta name="author" content="Stef van den Ham @stefvdham"><meta property="og:type" content="article"><meta property="og:image" content="http://mindthecode.com/images/og_image.png"><meta property="og:site_name" content="Mindthecode"><meta name="twitter:creator" content="@stefvdham"><meta name="twitter:card" content="summary"><meta name="twitter:image:" content="http://mindthecode.com/images/og_image.png"><meta name="keywords" content="html, javascript, code, hacking, tutorial, tutorials, web, css"><link rel="author" href="https://plus.google.com/102230925443628784177?rel=author"><link rel="canonical" href="http://mindthecode.com"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><title>Getting started with the PanResponder in React Native - Mindthecode</title><meta property="og:title" content="Getting started with the PanResponder in React Native"><meta property="og:url" content="http://mindthecode.com/getting-started-with-the-panresponder-in-react-native/"><meta property="og:description" content="Inside React Native you can use the PanResponder to recognize multi-touch gestures as well as swipes and other touches that make native apps feel snappy and intuitive. But getting it up and running can feel daunting and borderline black magic. In this post I'll try and guide you through the process, hopefully demystifying it a bit and get you on track to awesomeness."><meta name="twitter:title" content="Getting started with the PanResponder in React Native"><meta name="twitter:description" content="Inside React Native you can use the PanResponder to recognize multi-touch gestures as well as swipes and other touches that make native apps feel snappy and intuitive. But getting it up and running can feel daunting and borderline black magic. In this post I'll try and guide you through the process, hopefully demystifying it a bit and get you on track to awesomeness."><meta name="description" content="Inside React Native you can use the PanResponder to recognize multi-touch gestures as well as swipes and other touches that make native apps feel snappy and intuitive. But getting it up and running can feel daunting and borderline black magic. In this post I'll try and guide you through the process, hopefully demystifying it a bit and get you on track to awesomeness."><!-- != css('css/main')--><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><header><a href="/" class="logo"><img src="http://mindthecode.com/logo.png" height="30" class="floating"></a><nav><ul><li><a href="/">Blog</a></li><li><a href="/about">About</a></li><li><a href="/atom.xml">RSS</a></li></ul></nav></header><main><article class="post"><header><h1><span>Getting started with the PanResponder in React Native</span></h1><h5><span>Follow along as we tackle the madness that is the PanResponder.</span></h5><time datetime="2016-04-19T22:00:00.000Z" class="post__time">Apr 20 2016</time></header><hr/><p>Inside React Native you can use the PanResponder to recognize multi-touch gestures as well as swipes and other touches that make native apps feel snappy and intuitive. But getting it up and running can feel daunting and borderline black magic. In this post I’ll try and guide you through the process, hopefully demystifying it a bit and get you on track to awesomeness.</p>
<h2 id="What-we-will-be-making"><a href="#What-we-will-be-making" class="headerlink" title="What we will be making"></a>What we will be making</h2><p>Obviously we’ll be wanting to focus on the PanResponder itself so UI wise this will be pretty barebones. We’ll have an image on screen we can drag. When we release it it will bounce back to its original position. As a bonus, while we press down on the image it will scale up.</p>
<p><img src="/images/panresponder_demo.gif" alt="PanResponder Demo"></p>
<h2 id="Setting-the-stage"><a href="#Setting-the-stage" class="headerlink" title="Setting the stage"></a>Setting the stage</h2><p>I’ll be assuming you’re somewhat familiar with setting up a fresh React Native project. If not, the guys at Facebook have done an excellent job explaining the steps <a href="http://facebook.github.io/react-native/docs/getting-started.html#content" target="_blank" rel="external">right here</a>.</p>
<p>Let’s start with a new project. I’ll call it panresponder-demo for simplicity sake and lack of a name that rhymes with unicorns.</p>
<pre class=" language-bash"><code class="language-bash">$ react-native init panresponder_demo
</code></pre>
<p>First up, let’s add an image to the project that will act as your drag and drop target.</p>
<p>Create a directory <code>assets</code> to the panresponder_demo folder and insert the image you want to use in there. If you don’t have one, you can use <a href="/images/panresponder-target.png">this one</a>.</p>
<p>Let’s get our image on the screen so we can continue on to the cool part.</p>
<!-- Rectangle Ad -->
<p><center><br><ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-0534492338431642" data-ad-slot="3199566305"></ins><br></center></p>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>Open up <code>index.ios.js</code> and add the <code>Image</code> component at the top:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  AppRegistry<span class="token punctuation">,</span>
  Component<span class="token punctuation">,</span>
  StyleSheet<span class="token punctuation">,</span>
  Text<span class="token punctuation">,</span>
  View<span class="token punctuation">,</span>
  Image <span class="token comment" spellcheck="true">// we want to use an image</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-native'</span><span class="token punctuation">;</span>
</code></pre>
<p>Now replace the default app content with our Image so alter the <code>render()</code> method</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>container<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>Image source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./assets/panresponder.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>When you run the app now you should see the image in the center of the screen, waiting for you to do something more exciting. So let’s get to it.</p>
<p><img src="/images/panresponder_01.png" alt="Panresponder 01"></p>
<h2 id="Adding-the-PanResponder"><a href="#Adding-the-PanResponder" class="headerlink" title="Adding the PanResponder"></a>Adding the PanResponder</h2><p>Let’s get to the more interesting part. Adding the PanResponder system.</p>
<p>At the top, import <code>PanResponder</code> so we can use it. While we’re at it, we’ll also add <code>Animated</code> which allows us to use Animated values, which will come in handy for our animation and calculations.</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  AppRegistry<span class="token punctuation">,</span>
  Component<span class="token punctuation">,</span>
  StyleSheet<span class="token punctuation">,</span>
  Text<span class="token punctuation">,</span>
  View<span class="token punctuation">,</span>
  Image<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// we want to use an image</span>
  PanResponder<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// we want to bring in the PanResponder system</span>
  Animated <span class="token comment" spellcheck="true">// we wil be using animated value</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-native'</span><span class="token punctuation">;</span>
</code></pre>
<p>PanResponder basically consists of a couple of event-driven methods that you can implement. Once you’ve defined what you want it to behave like you attach it to a view, which will then propagate all the events (gestures) to the methods you hooked up.</p>
<p>To illustrate it in a simple way, let’s implement the <code>componentWillMount()</code> method and set up a basic PanResponder instance:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>_panResponder <span class="token operator">=</span> PanResponder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    onMoveShouldSetResponderCapture<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    onMoveShouldSetPanResponderCapture<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    onPanResponderGrant<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> gestureState<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    onPanResponderMove<span class="token punctuation">:</span> Animated<span class="token punctuation">.</span><span class="token function">event</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    onPanResponderRelease<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">{</span>vx<span class="token punctuation">,</span> vy<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>container<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>Animated<span class="token punctuation">.</span>View <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>_panResponder<span class="token punctuation">.</span>panHandlers<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>Image source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./assets/panresponder.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Animated<span class="token punctuation">.</span>View<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Whoa</strong>, lots going on here. Let’s break it down.</p>
<p><code>onMoveShouldSetResponderCapture</code> tells the OS we want to allow movement of the view we’ll attach this panresponder to. <code>onMoveShouldSetPanResponderCapture</code> does the same, but for dragging, which we want to be able to do.</p>
<p>Next up we got 3 methods that will be called <code>onPanResponderGrant</code> gets invoked when we got access to the movement of the element. This is a perfect spot to set some initial values.</p>
<p><code>onPanResponderMove</code> gets invoked when we move the element, which we can use to calculate the next value for the object</p>
<p><code>onPanResponderRelease</code> is invoked when we release the view. In a minute we’ll use this to make the image animated back to its original position</p>
<p>Last up, we add the panresponder to an <code>Animated.View</code> which we use to wrap the <code>Image</code> component in so it will obey our panresponding demands.</p>
<h2 id="Make-it-draggable"><a href="#Make-it-draggable" class="headerlink" title="Make it draggable"></a>Make it draggable</h2><p>Let’s implement the first 2 methods to be able to drag the image around the screen.</p>
<p>In order to keep track of where the image is on the screen we’ll want to keep a record of its position somewhere. This is the perfect job for a components <code>state</code>, so let’s add this:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
    pan<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Animated<span class="token punctuation">.</span>ValueXY</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Next, let’s update the <code>panHandler</code> implementation:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>_panResponder <span class="token operator">=</span> PanResponder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    onMoveShouldSetResponderCapture<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    onMoveShouldSetPanResponderCapture<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment" spellcheck="true">// Initially, set the value of x and y to 0 (the center of the screen)</span>
    onPanResponderGrant<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> gestureState<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment" spellcheck="true">// When we drag/pan the object, set the delate to the states pan position</span>
    onPanResponderMove<span class="token punctuation">:</span> Animated<span class="token punctuation">.</span><span class="token function">event</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>dx<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span>x<span class="token punctuation">,</span> dy<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    onPanResponderRelease<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">{</span>vx<span class="token punctuation">,</span> vy<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Basically, upon dragging we updat the states pan value, and when we move, we set the dx/dy to the value from the pan.</p>
<p>Now that we have our values, we can use this in our <code>render()</code> method, which gets called constantly as we’re dragging, so we can calculate the position of our image in there:</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Destructure the value of pan from the state</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> pan <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>

  <span class="token comment" spellcheck="true">// Calculate the x and y transform from the pan value</span>
  <span class="token keyword">let</span> <span class="token punctuation">[</span>translateX<span class="token punctuation">,</span> translateY<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>pan<span class="token punctuation">.</span>x<span class="token punctuation">,</span> pan<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment" spellcheck="true">// Calculate the transform property and set it as a value for our style which we add below to the Animated.View component</span>
  <span class="token keyword">let</span> imageStyle <span class="token operator">=</span> <span class="token punctuation">{</span>transform<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>translateX<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>translateY<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>View style<span class="token operator">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">.</span>container<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>Animated<span class="token punctuation">.</span>View style<span class="token operator">=</span><span class="token punctuation">{</span>imageStyle<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>_panResponder<span class="token punctuation">.</span>panHandlers<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>Image source<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./assets/panresponder.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Animated<span class="token punctuation">.</span>View<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="Getting-there"><a href="#Getting-there" class="headerlink" title="Getting there!"></a>Getting there!</h2><p>We’re getting somewhere. When you run the app now you will be able to drag the image around the screen! However, when you do this for a second time you will notice it starts from the middle of the screen again instead of following up where you left it.</p>
<p>Let’s fix that.</p>
<p>Fortunately, it’s quite simple. We need to alter the initial value in <code>onPanResponderGrant</code> to take in account the correct offset (we dragged it off center):</p>
<pre class=" language-javascript"><code class="language-javascript">onPanResponderGrant<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> gestureState<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Set the initial value to the current state</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span><span class="token function">setOffset</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span>x<span class="token punctuation">.</span>_value<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span>y<span class="token punctuation">.</span>_value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>If you were to run the code again you will notice a second drag and drop works perfectly, but every time after that the image will jump erratically. This has to do with the way the offset is calculated. We actually need to flatten this once you let go of the image. This can be done in our 3rd and last method:</p>
<pre class=" language-javascript"><code class="language-javascript">onPanResponderRelease<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">{</span>vx<span class="token punctuation">,</span> vy<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Flatten the offset to avoid erratic behavior</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span><span class="token function">flattenOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="Scaling-up-and-down"><a href="#Scaling-up-and-down" class="headerlink" title="Scaling up and down"></a>Scaling up and down</h2><p>Last but not least, lets make the image change in size while we’re dragging. First we’ll add a <code>scale</code> property to our state so we can use this in our style and influence its value in the PanResponder</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
  pan<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Animated<span class="token punctuation">.</span>ValueXY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  scale<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Animated<span class="token punctuation">.</span>Value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>We’ll use the value of this in our style inside the render method</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token operator">...</span>
<span class="token keyword">let</span> rotate <span class="token operator">=</span> <span class="token string">'0deg'</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// Calculate the transform property and set it as a value for our style which we add below to the Animated.View component</span>
<span class="token keyword">let</span> imageStyle <span class="token operator">=</span> <span class="token punctuation">{</span>transform<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>translateX<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>translateY<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>rotate<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>scale<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
</code></pre>
<p>With this in place all that’s left to do is influence the value of <code>scale</code> in the PanResponder implementation. When we start dragging the <code>onPanResponderGrant</code> method is invoked, so we can animate the value</p>
<pre class=" language-javascript"><code class="language-javascript">onPanResponderGrant<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> gestureState<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Set the initial value to the current state</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span><span class="token function">setOffset</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span>x<span class="token punctuation">.</span>_value<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span>y<span class="token punctuation">.</span>_value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Animated<span class="token punctuation">.</span><span class="token function">spring</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>scale<span class="token punctuation">,</span>
    <span class="token punctuation">{</span> toValue<span class="token punctuation">:</span> <span class="token number">1.1</span><span class="token punctuation">,</span> friction<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>and when we release it we’ll animate it back</p>
<pre class=" language-javascript"><code class="language-javascript">onPanResponderRelease<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">{</span>vx<span class="token punctuation">,</span> vy<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Flatten the offset to avoid erratic behavior</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>pan<span class="token punctuation">.</span><span class="token function">flattenOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Animated<span class="token punctuation">.</span><span class="token function">spring</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>scale<span class="token punctuation">,</span>
    <span class="token punctuation">{</span> toValue<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> friction<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>And that’s it! We got an image we can drag around, and it will give a visual indication we’re doing so (besides following our finger).</p>
<p>The resulting code can be found <a href="https://github.com/Hyra/panresponder_demo" target="_blank" rel="external">here on Github</a>, in case you didn’t follow along or want to review it.</p>
<p>As always, should you have any questions you can find me on Twitter.</p>
<p>Happy coding!</p>
<hr/><ul class="tags"><li>Tags: </li><li class="post__tag__item"><a href="/tags/react/" class="post__tag__link">react</a></li><li class="post__tag__item"><a href="/tags/react-native/" class="post__tag__link">react-native</a></li><li class="post__tag__item"><a href="/tags/javascript/" class="post__tag__link">javascript</a></li></ul><a href="https://twitter.com/intent/tweet" class="twitter-share-button">Tweet</a><hr/><h2>Questions or comments?</h2><p>As always, if you have any questions or comments, you can find me on <a href="http://twitter.com/stefvdham"   target="_blank">Twitter</a>.</p><div class="prevnext"><a href="/react-storybook/" class="prevnext-prev"><p>← Prev</p></a><a href="/setting-up-laravel-with-docker-compose/" class="prevnext-next"><p>Next →</p></a></div></article></main><footer><a href="/"><img src="http://mindthecode.com/images/mtc_inv_white.png" alt="Mindthecode" class="floating"></a><br><p>Made with ❤ and 🍺</p><p>Follow me on <a target="_blank" href="https://twitter.com/stefvdham">Twitter</a> or <a target="_blank" href="https://www.facebook.com/mindthecode/">Facebook</a></p><p>© Copyright 2011-2017</p></footer><script src="/js/main.js"></script><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&amp;serve=C6AILKT&amp;placement=mindthecode" id="_carbonads_js"></script></body></html>